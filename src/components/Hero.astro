---
import { Image } from 'astro:assets';
import heroBg from '../assets/hero-bg.jpg';
import Button from './UI/Button.astro';
---

<section class="relative min-h-screen flex flex-col items-center justify-center px-6 md:px-12 py-20 pt-32 md:py-20 md:pt-32">
  <div class="max-w-4xl w-full text-center space-y-4 md:space-y-4">
    <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-surface text-[11px] font-semibold tracking-wide mb-2 text-primary animate-fade-in-up">
      <span class="w-2 h-2 rounded-full bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.4)]"></span>
      Growth Partner since 2024
    </div>
    <div class="space-y-2 animate-fade-in-up">
      <h1 class="text-5xl md:text-7xl lg:text-8xl font-semibold tracking-tighter leading-[1.05] text-primary">
        Escalando Negocios
      </h1>
    
    </div>
    <div class="relative max-w-xl mx-auto">
      <p id="ghost-text" class="text-base md:text-lg text-primary/60 font-normal leading-relaxed pt-2 invisible" aria-hidden="true" style="visibility: hidden;">
        Somos tu socio estratégico para llevar tu negocio de donde está hoy, a donde merece estar mañana.
      </p>
      <p id="typewriter-text" class="absolute top-0 left-0 w-full h-full text-base md:text-lg text-primary/60 font-normal leading-relaxed pt-2">
      </p>
    </div>
    <div class="flex flex-col sm:flex-row gap-3 md:gap-4 justify-center pt-4 md:pt-4 animate-fade-in-up">
      <Button variant="primary" href="#contact">
        Trabajemos Juntos
      </Button>
      <button id="video-btn" class="group inline-flex items-center justify-center gap-2 px-6 py-3 rounded-full bg-white text-primary border border-primary/10 hover:bg-surface transition-all duration-300">
        <span class="material-symbols-outlined text-xl group-hover:scale-110 transition-transform">play_circle</span>
        <span class="font-medium">Ver Video</span>
      </button>
    </div>
  </div>
  
  <div class="mt-10 md:mt-12 w-full max-w-[1200px] mx-auto aspect-video rounded-3xl overflow-hidden shadow-2xl shadow-primary/10 border border-primary/5 relative group">
    <div class="absolute inset-0 bg-black/0 z-10 group-hover:bg-black/0 transition-colors duration-500"></div>
    <div class="w-full h-full relative overflow-hidden group-hover:scale-[1.02] transition-transform duration-1000 will-change-transform">
       <Image 
        src={heroBg} 
        alt="Cinematic landscape shot showing misty mountains in monochrome tones representing scope and vision"
        class="w-full h-full object-cover"
        loading="eager"
        fetchpriority="high"
        width={1200}
        height={675}
      />
    </div>
    <div class="absolute bottom-6 right-6 z-20">
      <div class="w-10 h-10 rounded-full bg-black/30 backdrop-blur-md flex items-center justify-center border border-white/10 hover:bg-black/50 transition-colors cursor-pointer">
        <span class="material-symbols-outlined text-white text-base">volume_off</span>
      </div>
    </div>
  </div>

  <!-- Video Modal -->
  <div id="video-modal" class="fixed inset-0 z-[100] bg-black/90 backdrop-blur-xl flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-500">
    <div class="relative w-full max-w-7xl aspect-video mx-4 md:mx-12 bg-black rounded-3xl overflow-hidden shadow-2xl border border-white/10 transform scale-95 transition-transform duration-500" id="video-container">
      <button id="close-video" class="absolute top-4 right-4 z-50 w-10 h-10 rounded-full bg-black/50 backdrop-blur-md flex items-center justify-center text-white hover:bg-white/20 transition-colors">
        <span class="material-symbols-outlined">close</span>
      </button>
      <div class="w-full h-full flex items-center justify-center text-white/50">
        <!-- Placeholder for future video -->
        <p class="text-lg">Video Próximamente</p>
        <!-- Example Embed (Hidden for now) -->
        <!-- <iframe class="w-full h-full" src="https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe> -->
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener('astro:page-load', () => {
    const ghostElement = document.getElementById('ghost-text');
    const targetElement = document.getElementById('typewriter-text');
    
    if (ghostElement && targetElement) {
      const text = ghostElement.textContent?.trim() || '';
      targetElement.textContent = '';
      
      let i = 0;
      const typeWriter = () => {
        if (i < text.length) {
          targetElement.textContent += text.charAt(i);
          i++;
          setTimeout(typeWriter, 45); // Slower speed (45ms)
        }
      };
      
      // Start animation with a slight delay
      setTimeout(typeWriter, 500);
    }

    // Video Modal Logic
    const videoBtn = document.getElementById('video-btn');
    const videoModal = document.getElementById('video-modal');
    const closeVideo = document.getElementById('close-video');
    const videoContainer = document.getElementById('video-container');

    if (videoBtn && videoModal && closeVideo) {
      // Remove existing listeners to avoid duplicates on re-render
      const newVideoBtn = videoBtn.cloneNode(true);
      videoBtn.parentNode?.replaceChild(newVideoBtn, videoBtn);
      
      const newCloseVideo = closeVideo.cloneNode(true);
      closeVideo.parentNode?.replaceChild(newCloseVideo, closeVideo);

      // Re-select elements after replacement
      const currentVideoBtn = document.getElementById('video-btn');
      const currentCloseVideo = document.getElementById('close-video');

      currentVideoBtn?.addEventListener('click', () => {
        videoModal.classList.remove('opacity-0', 'pointer-events-none');
        videoContainer?.classList.remove('scale-95');
        videoContainer?.classList.add('scale-100');
      });

      const closeModal = () => {
        videoModal.classList.add('opacity-0', 'pointer-events-none');
        videoContainer?.classList.add('scale-95');
        videoContainer?.classList.remove('scale-100');
      };

      currentCloseVideo?.addEventListener('click', closeModal);
      videoModal.addEventListener('click', (e) => {
        if (e.target === videoModal) closeModal();
      });
      
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeModal();
      });
    }
  });
</script>
